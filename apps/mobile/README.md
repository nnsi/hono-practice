# Actiko Mobile App

React Native (Expo) を使用したActikoのモバイルアプリケーション。

## 開発環境のセットアップ

### 前提条件

- Node.js 18以上
- Expo Go アプリ（実機テスト用）
- バックエンドサーバーが起動していること

### インストール

```bash
npm install
```

### 開発サーバーの起動

```bash
# Expoサーバーの起動
npm run start

# または特定のプラットフォーム向け
npm run ios      # iOSシミュレータ
npm run android  # Androidエミュレータ
npm run web      # Webブラウザ
```

## 実機での動作確認

### 1. ネットワーク設定の確認

実機とPCが同じネットワークに接続されていることを確認してください。

### 2. PCのIPアドレスを確認

```bash
# Windows
ipconfig

# macOS/Linux
ifconfig
# または
ip addr
```

例: `192.168.1.100`

### 3. バックエンドサーバーの起動

バックエンドサーバーを全てのインターフェースでリッスンするように起動します：

```bash
# プロジェクトルートで
npm run dev
```

### 4. Expoアプリで接続

1. 実機でExpo Goアプリを開く
2. QRコードをスキャンまたはURLを入力
3. アプリが起動したら、コンソールで接続情報を確認：

```
=== Connection Info ===
Platform: android/ios
__DEV__: true
API URL: http://192.168.1.100:3456
Expo Host: 192.168.1.100:8081
======================
```

## トラブルシューティング

### 実機から接続できない場合

1. **ファイアウォールの確認**
   - ポート3456（バックエンド）と8081（Expo）が開いているか確認
   - Windows: Windows Defenderファイアウォールで許可
   - macOS: システム環境設定 > セキュリティとプライバシー

2. **ネットワークの確認**
   - PCと実機が同じWi-Fiネットワークに接続されているか
   - PCのIPアドレスが正しいか

3. **環境変数の設定**
   
   特定のAPIサーバーを指定したい場合は、`.env`ファイルに設定：
   ```
   EXPO_PUBLIC_API_URL=http://192.168.1.100:3456
   ```

4. **バックエンドサーバーのバインドアドレス**
   
   バックエンドサーバーが`localhost`のみでリッスンしている場合、`0.0.0.0`でリッスンするように変更が必要な場合があります。

### Androidエミュレータの場合

Androidエミュレータから接続する場合は、自動的に`10.0.2.2:3456`に接続されます。

### iOSシミュレータの場合

iOSシミュレータは`localhost:3456`に直接接続できます。

## 認証フロー

1. **新規登録**
   - メールアドレス、パスワード、名前を入力
   - メールアドレスはログインIDとして使用

2. **ログイン**
   - メールアドレスとパスワードでログイン
   - JWTトークンをAsyncStorageに保存

3. **自動ログイン**
   - アプリ起動時に保存されたトークンをチェック
   - 有効なトークンがあれば自動的にログイン状態に

4. **ログアウト**
   - トークンをクリアしてログイン画面に戻る

## 注意事項

- 開発環境では自己署名証明書やHTTP接続を使用するため、本番環境では適切なHTTPS設定が必要です
- リフレッシュトークンは現在モバイルアプリでは使用していません（Cookieが使えないため）