name = "actiko-backend"
main = "apps/backend/server.cf.ts"
compatibility_date = "2025-01-12"
compatibility_flags = ["nodejs_compat"]

# DOマイグレーション: v1で作成したKeyValueDOをv2で削除
[[migrations]]
tag = "v1"
new_sqlite_classes = ["KeyValueDO"]

[[migrations]]
tag = "v2"
deleted_classes = ["KeyValueDO"]

# stg環境
[[env.stg.tail_consumers]]
service = "actiko-tail-worker-stg"

[env.stg.vars]
NODE_ENV = "stg"
STORAGE_TYPE = "r2"

# production環境
[[env.production.tail_consumers]]
service = "actiko-tail-worker-prod"

[env.production.vars]
NODE_ENV = "production"
STORAGE_TYPE = "r2"
